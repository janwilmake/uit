{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": false,
  "required": ["attribution"],
  "description": "context.json can be used to allow people to more easily understand the codebase through uithub and other context exploration interfaces. This schema format is designed to work with the Universal Information Terminal Hub (uithub).",
  "properties": {
    "$schema": {
      "type": "string",
      "default": "https://uuithub.com/context.schema.json"
    },
    "extends": {
      "oneOf": [
        { "type": "string", "format": "uri" },
        { "type": "array", "items": { "format": "uri", "type": "string" } }
      ],
      "description": "URI to base configuration file to inherit from",
      "default": "https://raw.githubusercontent.com/janwilmake/uit/refs/heads/main/default-faq.json"
    },

    "apiDependencies": {
      "description": "API Dependencies are dependencies on external APIs. Useful to keep track for context.",
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "scopes": { "type": "string" },
          "operationIds": { "type": "array", "items": { "type": "string" } }
        }
      }
    },

    "rules": {
      "type": "array",
      "description": "Array of rule items",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the rule"
          },
          "rule": {
            "type": "string",
            "description": "The rule content or identifier"
          },
          "description": {
            "type": "string",
            "description": "Optional description of the rule's purpose"
          },
          "alwaysApply": {
            "type": "boolean",
            "description": "Whether the rule should always be applied regardless of context"
          },
          "globs": {
            "oneOf": [
              {
                "type": "string",
                "description": "A single glob pattern to which this rule applies"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Multiple glob patterns to which this rule applies"
              }
            ],
            "description": "File patterns to which this rule applies"
          }
        },
        "required": ["name", "rule"],
        "additionalProperties": false
      }
    },

    "context": {
      "description": "Array of context; questions and filters. Only slug is required, and at least either question or filter.",
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["slug"],
        "properties": {
          "slug": {
            "type": "string",
            "maxLength": 40,
            "description": "URL-friendly identifier",
            "pattern": "^[a-zA-Z0-9_-]+$"
          },
          "title": {
            "type": "string",
            "description": "Title for quick navigation. If not given, slug is used."
          },
          "question": {
            "type": "string",
            "description": "One paragraph question to use in FAQ section",
            "maxLength": 140
          },
          "prompt": {
            "type": "string",
            "description": "Optional: a more extensive prompt to use instead of the question itself.",
            "maxLength": 16000
          },
          "basePath": {
            "type": "array",
            "items": { "type": "string" }
          },
          "pathPatterns": {
            "type": "array",
            "items": { "type": "string" },
            "description": "One or more glob patterns to include filepaths"
          },
          "excludePathPatterns": {
            "type": "array",
            "items": { "type": "string" },
            "description": "One or more glob patterns to exclude filepaths"
          },
          "maxFileSize": {
            "items": { "type": "number" },
            "description": "Maximum file size in bytes for files to include."
          },
          "filter": {
            "type": "string",
            "description": "querystring to apply to get trimmed down context. May include pathPatterns, excludePathPatterns, maxFileSize, along with other conventional params the client interface supports.",
            "maxLength": 16000
          },
          "preferredModel": {
            "type": "object",
            "description": "",
            "additionalProperties": false,
            "required": ["model", "endpoint", "key"],
            "properties": {
              "endpoint": { "type": "string" },
              "model": { "type": "string" },
              "key": {
                "type": "string",
                "description": "the environment variable key name to authorize usage of this model."
              }
            }
          }
        }
      }
    },
    "attribution": {
      "type": "string",
      "description": "Required attribution for Universal Information Terminal",
      "default": "Powered by Universal Information Terminal (UIT) by Jan Wilmake - https://github.com/janwilmake/uit"
    }
  }
}
